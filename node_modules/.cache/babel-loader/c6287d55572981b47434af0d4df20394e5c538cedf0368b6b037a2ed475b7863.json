{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chaha\\\\Downloads\\\\task15Making the mails Realtime\\\\src\\\\Components\\\\Pages\\\\ComoseMail.js\",\n  _s = $RefreshSig$();\nimport React, { useRef } from 'react';\nimport './Inbox';\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\nimport { Button } from 'react-bootstrap';\nimport { useSelector } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction removeSpecialChar(mail) {\n  let newMail = \"\";\n  for (let i = 0; i < mail.length; i++) {\n    if (mail[i] !== \"@\" && mail[i] !== \".\") {\n      newMail += mail[i];\n    }\n  }\n  return newMail;\n}\nfunction ComposeMail() {\n  _s();\n  const user = removeSpecialChar(useSelector(state => state.authentication.user));\n  const receiver = useRef();\n  const subject = useRef();\n  const mailBody = useRef();\n  const sender = useSelector(state => state.authentication.user);\n  const handleSendMail = async e => {\n    e.preventDefault();\n    console.log(\"sended\");\n    console.log(receiver.current.value, subject.current.value, mailBody.current.value, sender);\n    const newMail = {\n      mailSubject: subject.current.value,\n      mailContent: mailBody.current.value,\n      Sender: sender,\n      isReaded: false\n    };\n    if (receiver.current.value.length > 0 && mailBody.current.value.length > 0 && subject.current.value.length > 0) {\n      try {\n        let responce = await fetch(`https://mail-data-d37a7-default-rtdb.firebaseio.com//mail/${removeSpecialChar(receiver.current.value)}.json`, {\n          method: 'POST',\n          body: JSON.stringify(newMail),\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        if (responce.ok) {\n          let data = await responce.json();\n          console.log(data);\n          alert(\"mail sent successfully\");\n          try {\n            let responce = await fetch(`https://mail-data-d37a7-default-rtdb.firebaseio.com//sentmail/${user}.json`, {\n              method: 'POST',\n              body: JSON.stringify({\n                ...newMail,\n                receiver: receiver.current.value\n              }),\n              headers: {\n                'Content-Type': 'application/json'\n              }\n            });\n            if (responce.ok) {\n              let data = await responce.json();\n              console.log(data);\n              console.log(\"sent to sent mail\");\n            } else {\n              throw new Error(\"Failed to send in sent mail\");\n            }\n          } catch (error) {\n            console.log(error);\n          }\n        } else {\n          throw new Error(\"Failed to send mail\");\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    } else {\n      alert(\"please fill all the data\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-center\",\n        children: \"Draft your mail\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          className: \"form-control\",\n          id: \"exampleInputEmail1\",\n          placeholder: \"To\",\n          ref: receiver,\n          \"aria-describedby\": \"emailHelp\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          className: \"form-control\",\n          id: \"exampleInputSubject\",\n          ref: subject,\n          \"aria-describedby\": \"emailHelp\",\n          placeholder: \"Subject\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"w-100\",\n        style: {\n          height: \"20rem\"\n        },\n        ref: mailBody,\n        placeholder: \"Draft your mail here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container  text-center\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"primary\",\n        className: \"my-2 w-25\",\n        onClick: handleSendMail,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n_s(ComposeMail, \"AcxA/98ubf0SVqPQQXEx89M/sK4=\", false, function () {\n  return [useSelector, useSelector];\n});\n_c = ComposeMail;\nexport default ComposeMail;\nvar _c;\n$RefreshReg$(_c, \"ComposeMail\");","map":{"version":3,"names":["React","useRef","Button","useSelector","jsxDEV","_jsxDEV","Fragment","_Fragment","removeSpecialChar","mail","newMail","i","length","ComposeMail","_s","user","state","authentication","receiver","subject","mailBody","sender","handleSendMail","e","preventDefault","console","log","current","value","mailSubject","mailContent","Sender","isReaded","responce","fetch","method","body","JSON","stringify","headers","ok","data","json","alert","Error","error","children","className","fileName","_jsxFileName","lineNumber","columnNumber","type","id","placeholder","ref","style","height","variant","onClick","_c","$RefreshReg$"],"sources":["C:/Users/chaha/Downloads/task15Making the mails Realtime/src/Components/Pages/ComoseMail.js"],"sourcesContent":["import React, { useRef} from 'react';\nimport './Inbox'\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\nimport { Button } from 'react-bootstrap';\nimport { useSelector } from 'react-redux';\n\nfunction removeSpecialChar(mail) {\n    let newMail = \"\";\n    for (let i = 0; i < mail.length; i++) {\n        if (mail[i] !== \"@\" && mail[i] !== \".\") {\n            newMail += mail[i]\n        }\n    }\n    return newMail;\n}\n\nfunction ComposeMail() {\n    const user = removeSpecialChar(useSelector(state => state.authentication.user));\n    const receiver = useRef();\n    const subject = useRef();\n    const mailBody = useRef();\n    const sender = useSelector(state => state.authentication.user);\n\n    const handleSendMail = async (e) => {\n        e.preventDefault();\n        console.log(\"sended\");\n        console.log(receiver.current.value, subject.current.value, mailBody.current.value, sender);\n\n        const newMail = {\n            mailSubject: subject.current.value,\n            mailContent: mailBody.current.value,\n            Sender: sender,\n            isReaded:false\n        }\n\n        if (receiver.current.value.length > 0 && mailBody.current.value.length > 0 && subject.current.value.length > 0) {\n\n            try {\n                let responce = await fetch(\n                    `https://mail-data-d37a7-default-rtdb.firebaseio.com//mail/${removeSpecialChar(receiver.current.value)}.json`,\n                    {\n                        method: 'POST',\n                        body: JSON.stringify(newMail),\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    }\n                )\n                if (responce.ok) {\n                    let data = await responce.json();\n                    console.log(data);\n                    alert(\"mail sent successfully\");\n                    try {\n                        let responce = await fetch(\n                            `https://mail-data-d37a7-default-rtdb.firebaseio.com//sentmail/${user}.json`,\n                            {\n                                method: 'POST',\n                                body: JSON.stringify({...newMail,receiver:receiver.current.value}),\n                                headers: {\n                                    'Content-Type': 'application/json',\n                                },\n                            }\n                        )\n                        if (responce.ok) {\n                            let data = await responce.json();\n                            console.log(data);\n                           console.log(\"sent to sent mail\")\n                        } else {\n                            throw new Error(\"Failed to send in sent mail\")\n                        }\n                    } catch (error) {\n                        console.log(error)\n                    }\n\n                } else {\n                    throw new Error(\"Failed to send mail\")\n                }\n            } catch (error) {\n                console.log(error)\n            }\n        } else {\n            alert(\"please fill all the data\")\n        }\n    }\n\n    return (\n        <>\n            <div className=\"App container\">\n                <h1 className=\"text-center\">\n                    Draft your mail\n                </h1>\n                <div>\n                    <input type=\"email\" className=\"form-control\" id=\"exampleInputEmail1\" placeholder='To' ref={receiver} aria-describedby=\"emailHelp\" />\n                    <hr />\n                </div>\n                <div>\n                    <input type=\"email\" className=\"form-control\" id=\"exampleInputSubject\" ref={subject} aria-describedby=\"emailHelp\" placeholder='Subject' />\n                    <hr />\n                </div>\n                <textarea className='w-100' style={{ height: \"20rem\" }} ref={mailBody} placeholder='Draft your mail here' />\n\n            </div>\n            <div className='container  text-center'>\n                <Button variant=\"primary\" className='my-2 w-25' onClick={handleSendMail}>\n                    Send\n                </Button>\n            </div>\n        </>\n    )\n}\n\nexport default ComposeMail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}